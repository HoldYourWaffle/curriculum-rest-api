<title>SLO Curriculum Browser</title>
<base href="/curriculum/api/v1/">
<link rel="stylesheet" href="/assets/css/slo.css">

<body data-simply-path="/curriculum/">

<header class="slo-navbar">
    <nav class="slo-navbar-left slo-logo bg-brand">
        <a href="/"><img src="/assets/img/slo.png"></a>
    </nav>
    <div class="slo-navbar-left">
        OpenData Portal
    </div>
    <nav class="slo-navbar-right">
        <ul class="slo-navbar-nav slo-paging">
            <li>
                <button data-simply-command="previousPage"
                class="slo-button" title="vorige pagina"><svg
                class="slo-icon slo-icon-feather"><use
                xlink:href="/files/feather-sprite.svg#chevron-left"></use></svg></button>
            </li>
            <li>
                <span data-simply-field="page"></span> /
                <span data-simply-field="max"></span>
            <li>
                <button data-simply-command="nextPage" class="slo-button"
                title="volgende pagina"><svg
                class="slo-icon slo-icon-feather"><use
                xlink:href="/files/feather-sprite.svg#chevron-right"></use></svg></button>
            </li>
        </ul>
    </nav>
</header>

<nav class="slo-navbar slo-navbar-side bg-gray">
    <ul class="slo-navbar-nav" data-simply-list="menu" data-simply-path="/">
        <template>
            <li><i data-icon="ei-tag"></i>
            <a href="#" class="slo-nav" data-simply-field="link" data-simply-group="menu"
            data-simply-command="simply-select">link</a>
            <ul class="slo-navbar-nav" data-simply-list="submenu">
                <template data-simply-template="default">
                    <li><a class="slo-nav" href="#" data-simply-field="link" data-simply-group="menu"
                    data-simply-command="simply-select">link</a></li>
                </template>
            </ul>
        </template>
    </ul>
    <ul class="slo-navbar-nav">
        <li><a href="/curriculum/api/v1/" class="slo-nav" data-simply-group="menu">API Browser</a>
            <ul class="slo-navbar-nav">
                <li><a href="vak/" class="slo-nav" data-simply-group="menu">Vakken</a></li>
                <li><a href="vakkern/" class="slo-nav" data-simply-group="menu">Vakkernen</a></li>
                <li><a href="vaksubkern/" class="slo-nav" data-simply-group="menu">Vaksubkernen</a></li>
                <li><a href="vakinhoud/" class="slo-nav" data-simply-group="menu">Vakinhouden</a></li>
                <li><a href="niveau/" class="slo-nav" data-simply-group="menu">Niveau's</a></li>
                <li><a href="doelniveau/" class="slo-nav" data-simply-group="menu">Doelen op Niveau</a></li>
                <li><a href="doel/" class="slo-nav" data-simply-group="menu">Doelen</a></li>
                <li><a href="kerndoel/" class="slo-nav" data-simply-group="menu">Kerndoelen</a></li>
                <li><a href="kerndoel_domein/" class="slo-nav" data-simply-group="menu">Kerndoel Domeinen</a></li>
                <li><a href="kerndoel_uitstroomprofiel/" class="slo-nav" data-simply-group="menu">Kerndoel Uitstroomprofiel</a></li>
                <li><a href="kerndoel_vakleergebied/" class="slo-nav" data-simply-group="menu">Kerndoel Vakleergebied</a></li>
                <li><a href="ldk_vak/" class="slo-nav" data-simply-group="menu">Leerdoelkaart Vakken</a></li>
                <li><a href="ldk_vakkern/" class="slo-nav" data-simply-group="menu">Leerdoelkaart Vakkernen</a></li>
                <li><a href="ldk_vaksubkern/" class="slo-nav" data-simply-group="menu">Leerdoelkaart Vaksubkernen</a></li>
                <li><a href="ldk_vakinhoud/" class="slo-nav" data-simply-group="menu">Leerdoelkaart Vakinhouden</a></li>
            </ul>
        </li>
    </ul>
</nav>

<main class="slo-main">
    <div class="error" data-simply-field="error"></div>
    <section class="slo-text-content" data-simply-field="view" data-simply-content="template">
        <template data-simply-template="notfound">
            <h1>404: Page Not Found</h1>
            <p>Sorry, deze pagina bestaat niet.</p>
        </template>
        <template data-simply-template="list">
            <h1 data-simply-field="listTitle"></h1>
            <ul data-simply-list="list" xdata-simply-data="list">
                <template rel="links"></template>
            </ul>
        </template>
        <template data-simply-template="doelniveauList">
            <h1 data-simply-field="listTitle"></h1>
            <ul data-simply-list="list">
                <template rel="doelniveau"></template>
            </ul>
        </template>
        <template data-simply-template="item">
            <article>
                <h1 data-simply-field="item.title"></h1>
                <a class="slo-tag" href="#" data-simply-field="item.@id" data-simply-content="fixed">
                    <label class="slo-tag-label"><svg class="slo-icon slo-icon-feather">
                        <use xlink:href="/assets/icons/feather-sprite.svg#link">
                    </use></svg></label>
                    <span class="slo-id" data-simply-field="item.uuid"></span>
                </a>
                <div class="slo-tag">
                    <label class="slo-tag-label">Type</label>
                    <span data-simply-field="item.@type"></span>
                </div>
                <div class="slo-tag bg-brand" data-simply-field="item.unreleased" data-simply-content="template" data-simply-default-template="false">
                    <template data-simply-template="true">
                        Unreleased
                    </template>
                    <template data-simply-template="false">
                    </template>
                </div>
                <div data-simply-field="item.@type" data-simply-content="template">
                    <template data-simply-template="Deprecated">
                        <label>Vervangen door</label>
                        <ul data-simply-list="item.replacedBy">
                            <template rel="deprecatedLinks"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.replaces" data-simply-content="template"
                data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <label>Vervangt</label>
                        <ul data-simply-list="item.replaces">
                            <template rel="deprecatedLinks"></template>
                        </ul>
                    </template>
                </div>
              
                <div data-simply-field="item.description" data-simply-content="template"  data-simply-transformer="truthy">
                    <template>
                        <div data-simply-field="item.description"></div>
                    </template>
                </div>
                <div data-simply-field="item.Vak" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Vakken</h3>
                        <ul data-simply-list="item.Vak">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.Vakkern" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Vakkernen</h3>
                        <ul data-simply-list="item.Vakkern">
                            <template rel="links"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.Vaksubkern" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Vaksubkernen</h3>
                        <ul data-simply-list="item.Vaksubkern">
                            <template rel="links"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.Vakinhoud" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Vakinhouden</h3>
                        <ul data-simply-list="item.Vakinhoud">
                            <template rel="links"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.LdkVak" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Leerdoelkaart Vakken</h3>
                        <ul data-simply-list="item.LdkVak">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.LdkVakkern" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Leerdoelkaart Vakkernen</h3>
                        <ul data-simply-list="item.LdkVakkern">
                            <template rel="links"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.LdkVaksubkern" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Leerdoelkaart Vaksubkernen</h3>
                        <ul data-simply-list="item.LdkVaksubkern">
                            <template rel="links"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.LdkVakinhoud" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Leerdoelkaart Vakinhouden</h3>
                        <ul data-simply-list="item.LdkVakinhoud">
                            <template rel="links"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.Doelniveau" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Doelen op niveau</h3>
                        <ul data-simply-list="item.Doelniveau">
                            <template rel="doelniveau"></template>
                        </ul>
                    
                    </template>
                </div>
                <div data-simply-field="item.Doel" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Doelen</h3>
                        <ul data-simply-list="item.Doel">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.Kerndoel" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Kerndoelen</h3>
                        <ul data-simply-list="item.Kerndoel">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.KerndoelDomein" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Kerndoel domeinen</h3>
                        <ul data-simply-list="item.KerndoelDomein">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.KerndoelUitstroomprofiel" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Kerndoel uitstroomprofiel</h3>
                        <ul data-simply-list="item.KerndoelUitstroomprofiel">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.KerndoelVakleergebied" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Kerndoel vakleergebied</h3>
                        <ul data-simply-list="item.KerndoelVakleergebied">
                            <template rel="links"></template>
                        </ul>
                    </template>
                </div>
                <div data-simply-field="item.Niveau" data-simply-content="template"
                    data-simply-transformer="truthy">
                    <template data-simply-template="true">
                        <h3>Niveau's</h3>
                        <ul class="slo-navbar" data-simply-list="item.Niveau">
                            <template rel="refs"></template>
                        </ul>
                    </template>
                </div>
            </article>
        </template>
    </section>
</main>
<template id="deprecatedLinks">
    <li>
        <a href="#" data-simply-field="@id" data-simply-content="fixed">
            <span data-simply-field="title">titel</span>
        </a>
        <span data-simply-field="Vak" data-simply-content="template"
        data-simply-transformer="truthy">
            <template data-simply-template="true">
                <label>vak:
                    <ul data-simply-list="Vak">
                        <template rel="links"></template>
                    </ul>
                </label>
            </template>
        </span>
        <span data-simply-field="Vakkern" data-simply-content="template"
        data-simply-transformer="truthy">
            <template data-simply-template="true">
                <label>vakkern:
                <ul data-simply-list="Vakkern">
                    <template rel="links"></template>
                </ul>
                </label>
            </template>
        </span>
        <span data-simply-field="Vaksubkern" data-simply-content="template"
        data-simply-transformer="truthy">
            <template data-simply-template="true">
                <label>vaksubkern:
                <ul data-simply-list="Vaksubkern">
                    <template rel="links"></template>
                </ul>
                </label>
            </template>
        </span>
        <span data-simply-field="Vakinhoud" data-simply-content="template"
        data-simply-transformer="truthy">
            <template data-simply-template="true">
                <label>vakinhoud: 
                <ul data-simply-list="Vakinhoud">
                    <template rel="links"></template>
                </ul>
                </label>
            </template>
        </span>
        <span data-simply-field="$ref" data-simply-content="template"
        data-simply-transformer="truthy">
            <template data-simply-template="true">
                &nbsp;<a class="slo-tag slo-tag-inline" href="#" data-simply-field="$ref"
                data-simply-content="fixed" data-simply-transformer="niveau">
                    Op niveau
                </a>
            </template>
            <template data-simply-template="false">false</template>
        </span>
    </li>
</template>
<template id="links">
    <li>
        <a href="#" data-simply-field="@id" data-simply-content="fixed">
            <span data-simply-field="title">titel</span>
        </a>
        <span data-simply-field="$ref" data-simply-content="template"
        data-simply-transformer="truthy">
            <template data-simply-template="true">
                &nbsp;<a class="slo-tag slo-tag-inline" href="#" data-simply-field="$ref"
                data-simply-content="fixed" data-simply-transformer="niveau">
                    Op niveau
                </a>
            </template>
            <template data-simply-template="false">false</template>
        </span>
    </li>
</template>
<template id="doelniveau">
    <li>
        <a href="#" data-simply-field="@id" data-simply-content="fixed">
            <span data-simply-field="Doel.0.title">titel</span>
        </a>
        <ul data-simply-list="Niveau" class="slo-navbar slo-navbar-small">
             <template>
                 <li><span class="slo-tag" data-simply-field="title">niveau</span></li>
             </template>
        </ul>
    </li>
</template>
<template id="refs">
    <li>
        <a class="slo-tag" href="#" data-simply-field="$ref" data-simply-content="fixed">
            <span data-simply-field="title">titel</span>
        </a>
    </li>
</template>
<script src="//canary.simplyedit.io/1/simply-edit.js"></script>
<script src="/assets/simplyview/dist/simply.everything.js"></script>
<script>
    simply.bind = false; //don't use the simplyview databindings
    
    //FIXME: dit moet niet nodig zijn
    // bug is: ga naar een item (uuid/iets) ga naar een lijst (/vak/) ga
    // naar een item (uuid/iets) -> console geeft een error over 'dataParent
    // is undefined' ofzo.

    simply.route.goto = function(path) {
        window.location = baseURL + path;
    };

    var titles = {
        'vak/': 'Vakken',
        'vakkern/': 'Vakkernen',
        'vaksubkern/': 'Vaksubkernen',
        'vakinhoud/': 'Vakinhouden',
        'niveau/': 'Niveau\'s',
        'doel/': 'Doelen',
        'doelniveau/': 'Doelen op Niveau',
        'kerndoel/': 'Kerndoelen',
        'kerndoel_domein/': 'Kerndoel Domeinen',
        'kerndoel_uitstroomprofiel/': 'Kerndoel Uitstroomprofiel',
        'kerndoel_vakleergebied/': 'Kerndoel Vakleergebied',
        'ldk_vak/': 'Leerdoelkaart Vakken',
        'ldk_vakkern/': 'Leerdoelkaart Vakkernen',
        'ldk_vaksubkern/': 'Leerdoelkaart Vaksubkernen',
        'ldk_vakinhoud/': 'Leerdoelkaart Vakinhouden',
        'legacy': 'Vervangen door:'
    };
        
    var browser = simply.app({
        container: document.body,
        routes: {
            '/curriculum/api/v1/niveau/:niveau/vak/:vakid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'vak/', params.vakid);
            },
            '/curriculum/api/v1/niveau/:niveau/vakkern/:vakkernid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'vakkern/', params.vakkernid);
            },
            '/curriculum/api/v1/niveau/:niveau/vaksubkern/:vaksubkernid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'vaksubkern/', params.vaksubkernid);
            },
            '/curriculum/api/v1/niveau/:niveau/vakinhoud/:vakinhoudid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'vakinhoud/', params.vakinhoudid);
            },
            '/curriculum/api/v1/niveau/:niveau/vak/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vak/');
            },
            '/curriculum/api/v1/niveau/:niveau/vakkern/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vakkern/');
            },
            '/curriculum/api/v1/niveau/:niveau/vaksubkern/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vaksubkern/');
            },
            '/curriculum/api/v1/niveau/:niveau/vakinhoud/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vakinhoud/');
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vak/:vakid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'ldk_vak/', params.vakid);
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vakkern/:vakkernid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'ldk_vakkern/', params.vakkernid);
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vaksubkern/:vaksubkernid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'ldk_vaksubkern/', params.vaksubkernid);
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vakinhoud/:vakinhoudid': function(params) {
                browser.actions.itemOpNiveau(params.niveau, 'ldk_vakinhoud/', params.vakinhoudid);
            },
            '/curriculum/api/v1/niveau/:niveau/vak/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vak/');
            },
            '/curriculum/api/v1/niveau/:niveau/vakkern/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vakkern/');
            },
            '/curriculum/api/v1/niveau/:niveau/vaksubkern/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vaksubkern/');
            },
            '/curriculum/api/v1/niveau/:niveau/vakinhoud/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'vakinhoud/');
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vak/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'ldk_vak/');
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vakkern/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'ldk_vakkern/');
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vaksubkern/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'ldk_vaksubkern/');
            },
            '/curriculum/api/v1/niveau/:niveau/ldk_vakinhoud/': function(params) {
                browser.actions.listOpNiveau(params.niveau, 'ldk_vakinhoud/');
            },
            '/curriculum/api/v1/niveau/:niveau': function(params) {
                browser.actions.item(params.niveau);
            },
            '/curriculum/api/v1/vak/': function(params) {
                browser.actions.list('vak/')
            },
            '/curriculum/api/v1/vakkern/': function(params) {
                browser.actions.list('vakkern/')
            },
            '/curriculum/api/v1/vaksubkern/': function(params) {
                browser.actions.list('vaksubkern/')
            },
            '/curriculum/api/v1/vakinhoud/': function(params) {
                browser.actions.list('vakinhoud/')
            },
            '/curriculum/api/v1/niveau/': function(params) {
                browser.actions.list('niveau/')
            },
            '/curriculum/api/v1/doelniveau/': function(params) {
                browser.actions.doelniveauList('doelniveau/')
            },
            '/curriculum/api/v1/doel/': function(params) {
                browser.actions.list('doel/')
            },
            '/curriculum/api/v1/ldk_vak/': function(params) {
                browser.actions.list('ldk_vak/')
            },
            '/curriculum/api/v1/ldk_vakkern/': function(params) {
                browser.actions.list('ldk_vakkern/')
            },
            '/curriculum/api/v1/ldk_vaksubkern/': function(params) {
                browser.actions.list('ldk_vaksubkern/')
            },
            '/curriculum/api/v1/ldk_vakinhoud/': function(params) {
                browser.actions.list('ldk_vakinhoud/')
            },
            '/curriculum/api/v1/kerndoel/': function(params) {
                browser.actions.list('kerndoel/')
            },
            '/curriculum/api/v1/kerndoel_domein/': function(params) {
                browser.actions.list('kerndoel_domein/')
            },
            '/curriculum/api/v1/kerndoel_uitstroomprofiel/': function(params) {
                browser.actions.list('kerndoel_uitstroomprofiel/')
            },
            '/curriculum/api/v1/kerndoel_vakleergebied/': function(params) {
                browser.actions.list('kerndoel_vakleergebied/')
            },
            '/curriculum/uuid/:id': function(params) {
                browser.actions.item(params.id);
            },
            '/curriculum/api/v1/legacy/vak/:vak/vakkern/:vakkern/vaksubkern/:vaksubkern/vakinhoud/:vakinhoud': function(params) {
                browser.actions.legacy(params);
            },            
            '/curriculum/api/v1/legacy/vak/:vak/vakkern/:vakkern/vaksubkern/:vaksubkern': function(params) {
                browser.actions.legacy(params);
            },
            '/curriculum/api/v1/legacy/vak/:vak/vakkern/:vakkern': function(params) {
                browser.actions.legacy(params);
            },
            '/curriculum/api/v1/legacy/vak/:vak': function(params) {
                browser.actions.legacy(params);
            },
            '/curriculum/api/v1/:*': function(params) {
                if (params.remainder) {
                    browser.actions.notfound(params.remainder);
                }
            }
        },
        commands: {
            nextPage: function(el,value) {
                page = Math.min(browser.view.max-1, parseInt(browser.view.page));
                browser.actions.updatePage(page);
            },
            previousPage: function(el,value) {
                page = Math.max(0, browser.view.page-2);
                browser.actions.updatePage(page);
            }
        },
        actions: {
            updatePage: function(page) {
                window.location.search =
                '?'+Object.keys(browser.view.params).map(function(key) {
                    if (key=='page') {
                        return 'page='+page;
                    }
                    return encodeURIComponent(key)+'='+encodeURIComponent(browser.view.params[key]);
                }).join('&');
            },
            list: function(type) {
                return slo.api.get('/curriculum/api/v1/'+type)
                .then(function(json) {
                    browser.view.view = 'list';
                    browser.view.list = json.data;
                    browser.view['listTitle'] = titles[type];
                    browser.actions.updatePaging(json.count);
//                    editor.addDataSource('list', {
//                        load: json
//                    });
                })
                .catch(function(error) {
                });
            },
            doelniveauList: function(type) {
                return slo.api.get('/curriculum/api/v1/'+type)
                .then(function(json) {
                    browser.view.view = 'doelniveauList';
                    browser.view.list = json.data;
                    browser.view['listTitle'] = titles[type];
                    browser.actions.updatePaging(json.count);
                });
            },
            item: function(id) {
                return slo.api.get('/curriculum/api/v1/uuid/'+id+'/')
                .then(function(json) {
                    browser.view.view = 'item';
                    browser.view.item = json;
                    browser.actions.updatePaging();
                });
            },
            listOpNiveau: function(niveau, type) {
                return slo.api.get('/curriculum/api/v1/niveau/'+niveau+'/'+type)
                .then(function(json) {
                    browser.view.view = 'list';
                    browser.view.list = json;
                    browser.view['listTitle'] = titles[type];
                    browser.actions.updatePaging();
                });
            },
            itemOpNiveau: function(niveau, type, id) {
                return slo.api.get('/curriculum/api/v1/niveau/'+niveau+'/'+type+id)
                .then(function(json) {
                    browser.view.view = 'item';
                    browser.view.item = json;
                    browser.actions.updatePaging();
                });
            },
            notfound: function(remainder) {
                browser.view.view = 'notfound';
                browser.actions.updatePaging();
            },
            legacy: function(params) {
                var url = '/curriculum/api/v1/legacy/';
                ['vak','vakkern','vaksubkern','vakinhoud'].forEach(function(inhoud)
                {
                    if (params[inhoud]) {
                        url += inhoud+'/'+params[inhoud]+'/';
                    }
                });
                return slo.api.get(url)
                .then(function(json) {
                    browser.view.view = 'list';
                    browser.view.list = json.data;
                    browser.view['listTitle'] = titles['legacy'];
                    browser.actions.updatePaging();
                });
            },
            updatePaging: function(count) {
                if (!count || count<browser.view.pageSize) {
                    document.body.classList.remove('slo-paging');
                } else {
                    document.body.classList.add('slo-paging');
                    var total = parseInt(count);
                    var pages = total / browser.view.pageSize;
                    browser.view.max = Math.ceil(pages);
                }
            }
        }
    });

    browser.view.pageSize = 100;
        
    const baseURL = 'https://opendata.slo.nl';
    var slo = {
        api: {
            get: function(path, params) {
                var url = baseURL + path;
                if (!params && window.location.search) {
                    url = url + window.location.search;
                }
                if (params) {
                    var args = Object.keys(params).map(function(param) {
                        return encodeURIComponent(param)+'='+encodeURIComponent(params[param]);
                    }).join('&');
                    url = url + '?' + args;
                }
                return fetch(url, {
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(function(response) {
                    var json = response.json();
                    if (response.ok) {
                        return json;
                    }
                    return json.then(Promise.reject.bind(Promise));
                })
                .then(function(json) {
                    if (json.error) {
                        browser.view.error = json.error;
                    } else {
                        browser.view.error = '';
                    }
                    return json;
                });
            }
        }
    }

    editor.transformers.truthy = {
        render: function(data) {
            this.originalValue = data;
            if (Array.isArray(data)) {
                return data.length > 0 ? "true" : "false";
            } else if (!Array.isArray(data)) {
                return !!data ? "true" : "false";;
            }
            return "false"
        },
        extract: function(data) {
            return this.originalValue;
        }
    };
    
    editor.transformers.niveau = {
        render: function(data) {
            this.innerHTML = browser.view.item.title;
            return data;
        }
    };
    
    document.addEventListener('simply-content-loaded', function(evt) {
        var menu = editor.currentData['/'].menu;
        var api = menu[0].submenu[0]['data-simply-template'] = 'api';
    });
    
    var parseQueryString = function( queryString ) {
        var params = {}, queries, temp, i, l;
        if (queryString) {
            // Split into key/value pairs
            queries = queryString.split("&");
            // Convert the array of strings into an object
            for ( i = 0, l = queries.length; i < l; i++ ) {
                temp = queries[i].split('=');
                params[temp[0]] = temp[1];
            }
        }
        return params;
    };
    
    var args = parseQueryString(window.location.search.substring(1, window.location.search.length));
    if (!args.page) {
        args.page = 0;
    }
    browser.view.page = parseInt(args.page)+1;
    browser.view.params = args;

</script>
</body>